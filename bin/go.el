
(defun golint-file()
  (interactive)
  (go-remove-unused-imports 1)
  (shell-command (format "golint %s" (buffer-file-name)))
  )

(defun go-find-referencs2()
  (interactive)
  (shell-command (format "go-find-references -file %s -offset %d" (buffer-file-name) (point)))
  )

(defun godoc-at-point2()
  (interactive)
  (godoc (word-at-point))
  (next-window)
  )

(defun go-yank-and-indent ()
  (interactive)
  (if (not (equal mark-active nil))
      (delete-region (mark) (point))
    )
  (setq begin-line (line-number-at-pos))
  (yank)
  (setq end-line (line-number-at-pos))
  (if (> end-line begin-line)
      (progn (while (>= end-line begin-line)
               (progn (goto-line begin-line)    
                      (go-mode-indent-line)
                      (setq begin-line (+ begin-line 1))
                      )
               )
             (end-of-line)
             )
    (go-mode-indent-line)
    )
  )

(defun go-big(arg)
  (interactive "p")
  (self-insert-command arg)
  (newline 2)
  (insert-char ?})
  (go-mode-indent-line)
  (previous-line)
  (go-mode-indent-line)
  )

(defun go-middle(arg)
  (interactive "p")
  (self-insert-command arg)
  (insert-char ?\])
  (backward-char)
  )

(defun go-small(arg)
  (interactive "p")
  (self-insert-command arg)
  (insert-char ?\))
  (backward-char)
  )

(defun go-double-qoute(arg)
  (interactive "p")
  (self-insert-command arg)
  (insert-char ?\")
  (backward-char)
  )


(defun go-qoute(arg)
  (interactive "p")
  (self-insert-command arg)
  (insert-char ?\')
  (backward-char)
  )


(defun go-keymap-hook ()
  (local-set-key (kbd "\"") 'go-double-qoute)
  (local-set-key (kbd "\'") 'go-qoute)
  (local-set-key (kbd "(") 'go-small)
  (local-set-key (kbd "[") 'go-middle)
  (local-set-key (kbd "{") 'go-big)
  (local-set-key (kbd "C-y") 'go-yank-and-indent)
  (local-set-key (kbd "M-h") 'godoc-at-point2)
  (local-set-key (kbd "C-7") 'golint-file)
  (local-set-key (kbd "M-t") 'godef-jump-other-window)
  (local-set-key (kbd "M-r") 'go-find-referencs2)
)
(add-hook 'go-mode-hook 'go-keymap-hook)

